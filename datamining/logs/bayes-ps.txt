=== Run information ===

Scheme:       weka.classifiers.bayes.NaiveBayes -batch-size 128 -D
Relation:     remaining_behavior_ext
Instances:    34422
Attributes:   10
              inter_api_access_duration(sec)
              api_access_uniqueness
              sequence_length(count)
              vsession_duration(min)
              ip_type
              behavior_type
              num_sessions
              num_users
              num_unique_apis
              source
Test mode:    split 66.0% train, remainder test

=== Classifier model (full training set) ===

Naive Bayes Classifier

                                   Class
Attribute                         attack     bot  normal outlier
                                     (0)  (0.04)  (0.26)   (0.7)
=================================================================
inter_api_access_duration(sec)
  '(-inf-0.000023]'                   1.0     5.0    13.0    56.0
  '(0.000023-0.00011]'                1.0   206.0    31.0    45.0
  '(0.00011-0.000153]'                1.0    61.0    14.0    50.0
  '(0.000153-0.001999]'               1.0    57.0   191.0   416.0
  '(0.001999-0.002003]'               1.0     1.0     1.0    23.0
  '(0.002003-0.03384]'                1.0   587.0   917.0  1110.0
  '(0.03384-0.686796]'                1.0    41.0  2950.0  4164.0
  '(0.686796-1.649841]'               1.0    10.0  1385.0  3088.0
  '(1.649841-4.710068]'               1.0    50.0  1526.0  4796.0
  '(4.710068-11.931596]'              5.0    46.0   897.0  4247.0
  '(11.931596-518.114952]'           19.0   242.0  1030.0  5970.0
  '(518.114952-inf)'                  1.0    15.0     3.0   192.0
  [total]                            34.0  1321.0  8958.0 24157.0

api_access_uniqueness
  '(-inf-0.010052]'                   1.0     4.0   165.0   165.0
  '(0.010052-0.019995]'               1.0     8.0   367.0    55.0
  '(0.019995-0.020004]'               1.0     1.0     1.0    21.0
  '(0.020004-0.026521]'               1.0    29.0   235.0    53.0
  '(0.026521-0.05596]'                1.0   220.0   728.0   378.0
  '(0.05596-0.097837]'                2.0   258.0   804.0   770.0
  '(0.097837-0.127077]'               8.0    64.0   569.0   624.0
  '(0.127077-0.217971]'               5.0   132.0  1702.0  2618.0
  '(0.217971-0.249402]'               2.0     7.0   421.0   904.0
  '(0.249402-0.250514]'               1.0    56.0   177.0   224.0
  '(0.250514-0.332456]'               4.0    24.0   980.0  2231.0
  '(0.332456-0.334234]'               1.0    52.0   264.0   321.0
  '(0.334234-0.374416]'               1.0     4.0   318.0   822.0
  '(0.374416-0.375573]'               1.0    12.0    95.0   134.0
  '(0.375573-0.48734]'                2.0    21.0   886.0  2426.0
  '(0.48734-0.497899]'                2.0     2.0     2.0    69.0
  '(0.497899-0.503012]'               2.0   160.0   553.0   822.0
  '(0.503012-0.626059]'               1.0    14.0   420.0  2317.0
  '(0.626059-0.752778]'               3.0    43.0   234.0  2721.0
  '(0.752778-0.979167]'               2.0    12.0    45.0  3199.0
  '(0.979167-inf)'                    1.0   207.0     1.0  3292.0
  [total]                            43.0  1330.0  8967.0 24166.0

sequence_length(count)
  '(-inf-1.733333]'                   1.0    38.0     5.0     3.0
  '(1.733333-2.00641]'                1.0   401.0   480.0   220.0
  '(2.00641-2.198958]'                1.0     1.0    81.0     1.0
  '(2.198958-2.505814]'               1.0    49.0   272.0     1.0
  '(2.505814-2.995238]'               1.0    78.0   119.0     1.0
  '(2.995238-3.051316]'               1.0    44.0   251.0  1295.0
  '(3.051316-3.985714]'               1.0    44.0   347.0     1.0
  '(3.985714-4.015951]'               1.0    36.0   195.0  1347.0
  '(4.015951-4.973684]'               1.0    16.0   393.0     1.0
  '(4.973684-5.016129]'               1.0    13.0   144.0   996.0
  '(5.016129-5.987179]'               1.0    12.0   353.0     1.0
  '(5.987179-6.014706]'               1.0    11.0   186.0   954.0
  '(6.014706-6.993151]'               1.0    21.0   317.0     1.0
  '(6.993151-7.010638]'               1.0     8.0   141.0   933.0
  '(7.010638-7.990741]'               1.0    19.0   305.0     1.0
  '(7.990741-8.02381]'                1.0    14.0   111.0   818.0
  '(8.02381-8.990385]'                1.0    17.0   267.0     1.0
  '(8.990385-9.012821]'               1.0     6.0    71.0   773.0
  '(9.012821-9.983333]'               1.0    14.0   242.0     1.0
  '(9.983333-10.035714]'              1.0     8.0    84.0   678.0
  '(10.035714-10.447222]'             1.0    18.0    76.0     1.0
  '(10.447222-10.966667]'             1.0     6.0   167.0     1.0
  '(10.966667-11.017857]'             1.0    11.0    94.0   653.0
  '(11.017857-11.994898]'             1.0    12.0   214.0     1.0
  '(11.994898-12.016129]'             1.0     8.0    81.0   609.0
  '(12.016129-12.973684]'             1.0    15.0   205.0     1.0
  '(12.973684-13.010417]'             2.0     9.0    74.0   471.0
  '(13.010417-13.98913]'              1.0    13.0   170.0     1.0
  '(13.98913-14.011364]'              1.0     3.0    68.0   455.0
  '(14.011364-14.994565]'             1.0    12.0   157.0     1.0
  '(14.994565-15.027778]'             1.0     5.0    59.0   414.0
  '(15.027778-15.984848]'             1.0    14.0   139.0     1.0
  '(15.984848-16.021739]'             1.0     6.0    35.0   354.0
  '(16.021739-16.985714]'             1.0    13.0   121.0     1.0
  '(16.985714-17.017857]'             1.0     4.0    37.0   311.0
  '(17.017857-17.96875]'              1.0    10.0   133.0     1.0
  '(17.96875-18.029412]'              1.0     4.0    48.0   328.0
  '(18.029412-18.921053]'             1.0     6.0    91.0     1.0
  '(18.921053-19.029412]'             1.0     4.0    37.0   337.0
  '(19.029412-19.973684]'             1.0     5.0    81.0     1.0
  '(19.973684-20.033333]'             1.0     2.0    36.0   293.0
  '(20.033333-20.966667]'             1.0     6.0    75.0     1.0
  '(20.966667-21.035714]'             1.0     5.0    28.0   266.0
  '(21.035714-21.964286]'             1.0     9.0    74.0     1.0
  '(21.964286-22.041667]'             1.0     4.0    21.0   234.0
  '(22.041667-22.966667]'             1.0     4.0    62.0     1.0
  '(22.966667-45.032258]'             5.0    86.0   715.0  3285.0
  '(45.032258-45.945652]'             1.0     1.0    14.0     1.0
  '(45.945652-89.3875]'               6.0    36.0   869.0  2703.0
  '(89.3875-166.5]'                   6.0   162.0   362.0  2251.0
  '(166.5-199.375]'                   4.0     8.0    38.0   684.0
  '(199.375-200.75]'                  5.0     7.0    75.0   235.0
  '(200.75-inf)'                      1.0     4.0   179.0  2273.0
  [total]                            75.0  1362.0  8999.0 24198.0

vsession_duration(min)
  '(-inf-1.5]'                        1.0   114.0    67.0   330.0
  '(1.5-2.5]'                         1.0   175.0    22.0   615.0
  '(2.5-4.5]'                         1.0   497.0    76.0   282.0
  '(4.5-5.5]'                         1.0    25.0    36.0    81.0
  '(5.5-114.5]'                       1.0   111.0   816.0  1979.0
  '(114.5-166.5]'                     1.0    19.0   293.0   461.0
  '(166.5-11650.5]'                   2.0    67.0  5101.0 10100.0
  '(11650.5-21766.5]'                 1.0    28.0  1048.0  2681.0
  '(21766.5-99390]'                   3.0    91.0  1201.0  5467.0
  '(99390-109109]'                    2.0    24.0    36.0   243.0
  '(109109-111437.5]'                 1.0    75.0    11.0    52.0
  '(111437.5-259386.5]'              19.0    33.0   209.0  1420.0
  '(259386.5-inf)'                    1.0    63.0    43.0   447.0
  [total]                            35.0  1322.0  8959.0 24158.0

ip_type
  datacenter                          1.0    11.0     1.0   129.0
  default                            23.0  1163.0  8947.0 22770.0
  google_bot                          1.0     1.0     1.0     2.0
  private_ip                          1.0   138.0     1.0  1248.0
  [total]                            26.0  1313.0  8950.0 24149.0

num_sessions
  '(-inf-1.5]'                       22.0   378.0   135.0 17791.0
  '(1.5-2.5]'                         1.0   192.0  1687.0  4278.0
  '(2.5-3.5]'                         1.0    75.0  1326.0   756.0
  '(3.5-22.5]'                        2.0   211.0  4493.0  1061.0
  '(22.5-110.5]'                      1.0   268.0  1280.0   179.0
  '(110.5-164.5]'                     1.0     5.0    29.0    34.0
  '(164.5-183.5]'                     1.0     8.0     3.0     7.0
  '(183.5-593]'                       1.0    88.0     1.0     1.0
  '(593-713]'                         1.0     4.0     1.0    18.0
  '(713-inf)'                         1.0    90.0     1.0    30.0
  [total]                            32.0  1319.0  8956.0 24155.0

num_users
  '(-inf-1.5]'                       22.0   434.0     1.0 24146.0
  '(1.5-3.5]'                         2.0   284.0  4299.0     1.0
  '(3.5-8.5]'                         1.0   247.0  2357.0     1.0
  '(8.5-9.5]'                         1.0   157.0   236.0     1.0
  '(9.5-22.5]'                        1.0    97.0  1145.0     1.0
  '(22.5-75.5]'                       1.0     9.0   811.0     1.0
  '(75.5-100.5]'                      1.0    31.0   104.0     1.0
  '(100.5-inf)'                       1.0    58.0     1.0     1.0
  [total]                            30.0  1317.0  8954.0 24153.0

num_unique_apis
  '(-inf-1.5]'                        1.0    68.0   106.0   440.0
  '(1.5-2.5]'                         1.0   481.0   692.0   784.0
  '(2.5-4.5]'                         1.0   208.0  1022.0  3986.0
  '(4.5-8.5]'                         1.0   185.0  1873.0  5606.0
  '(8.5-18.5]'                        2.0   114.0  2735.0  6131.0
  '(18.5-24.5]'                      22.0    63.0   847.0  1977.0
  '(24.5-42.5]'                       1.0   189.0  1276.0  3216.0
  '(42.5-66.5]'                       1.0     9.0   382.0  1602.0
  '(66.5-inf)'                        1.0     1.0    22.0   412.0
  [total]                            31.0  1318.0  8955.0 24154.0

source
  E                                   1.0  1192.0     6.0 16593.0
  F                                  23.0   119.0  8942.0  7554.0
  [total]                            24.0  1311.0  8948.0 24147.0



Time taken to build model: 0.17 seconds

=== Evaluation on test split ===

Time taken to test model on test split: 0.03 seconds

=== Summary ===

Correctly Classified Instances       11353               97.0093 %
Incorrectly Classified Instances       350                2.9907 %
Kappa statistic                          0.9339
Mean absolute error                      0.0157
Root mean squared error                  0.1085
Relative absolute error                  7.1472 %
Root relative squared error             32.5547 %
Total Number of Instances            11703     

=== Detailed Accuracy By Class ===

                 TP Rate  FP Rate  Precision  Recall   F-Measure  MCC      ROC Area  PRC Area  Class
                 0.000    0.001    0.000      0.000    0.000      -0.001   0.991     0.078     attack
                 0.808    0.022    0.588      0.808    0.681      0.675    0.970     0.831     bot
                 0.988    0.001    0.996      0.988    0.992      0.989    1.000     1.000     normal
                 0.973    0.023    0.990      0.973    0.981      0.940    0.996     0.998     outlier
Weighted Avg.    0.970    0.017    0.976      0.970    0.972      0.943    0.996     0.991     

=== Confusion Matrix ===

    a    b    c    d   <-- classified as
    0    0    1    9 |    a = attack
    2  357   10   73 |    b = bot
    1   36 3077    0 |    c = normal
    4  214    0 7919 |    d = outlier

